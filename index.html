<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Design | Creative SaaS Solutions</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <meta name="description" content="Creative SaaS Solutions - logos, websites, templates & more.">
  <meta name="keywords" content="graphic design, web design, logos, invitations, templates">
  <meta name="author" content="The Design">

  <style>
    :root {
      --chat-primary: #3b82f6; /* blue-500 */
      --chat-secondary: #4f46e5; /* indigo-600 */
      --chat-bg: #f8fafc; /* slate-50 */
      --chat-text: #1e293b; /* slate-800 */
      --bot-bg: #e2e8f0; /* slate-200 */
      --user-bg: #3b82f6; /* blue-500 */
      --user-text: #ffffff;
    }

    #ai-chat-container {
  position: fixed;
  bottom: 20px;
  right: 20px;
  z-index: 1000;
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 10px;
}

#chat-icon-container {
  z-index: 1001;
}

#chat-icon {
  position: fixed;
  bottom: 20px;
  right: 20px;
  width: 60px;
  height: 60px;
  background-color: #6366f1; /* customize color */
  color: white;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 10px 20px rgba(0,0,0,0.2);
  cursor: pointer;
  z-index: 1000;
}

#chat-icon svg {
  width: 32px;
  height: 32px;
}

#chat-window {
  position: fixed;
  bottom: 90px;
  right: 20px;
  width: 360px;
  height: 480px;
  background: white;
  border-radius: 12px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.2);
  z-index: 1000;
}

#chat-icon:hover {
  transform: scale(1.1);
}

#chat-icon svg {
  width: 32px;
  height: 32px;
}

    
    #chat-window {
      width: clamp(300px, 90vw, 400px);
      max-height: 70vh;
      background-color: var(--chat-bg);
      border-radius: 16px;
      box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1), 0 10px 10px -5px rgba(0,0,0,0.04);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      transition: opacity 0.3s ease, transform 0.3s ease;
      transform-origin: bottom right;
    }

    #chat-window.hidden {
      opacity: 0;
      transform: scale(0.5);
      pointer-events: none;
    }
    
    #chat-icon.hidden {
      display: none;
    }

    .chat-header {
      padding: 16px;
      background: linear-gradient(45deg, var(--chat-primary), var(--chat-secondary));
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid transparent;
    }
    .chat-header h3 {
      font-weight: bold;
      font-size: 1.1rem;
    }
    .chat-header button {
      background: none;
      border: none;
      color: white;
      cursor: pointer;
      padding: 0;
    }
    .chat-header button svg {
      width: 24px;
      height: 24px;
    }

    .chat-body {
      flex: 1;
      padding: 16px 8px 16px 16px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    
    /* Custom scrollbar for webkit browsers */
    .chat-body::-webkit-scrollbar {
      width: 6px;
    }
    .chat-body::-webkit-scrollbar-track {
      background: var(--chat-bg);
    }
    .chat-body::-webkit-scrollbar-thumb {
      background-color: #cbd5e1; /* slate-300 */
      border-radius: 20px;
    }

    .message-bubble {
      max-width: 85%;
      padding: 10px 14px;
      border-radius: 18px;
      font-size: 0.95rem;
      line-height: 1.4;
      word-wrap: break-word;
      white-space: pre-wrap;
    }

    .bot-message {
      background-color: var(--bot-bg);
      color: var(--chat-text);
      align-self: flex-start;
      border-bottom-left-radius: 4px;
    }
    .user-message {
      background-color: var(--user-bg);
      color: var(--user-text);
      align-self: flex-end;
      border-bottom-right-radius: 4px;
    }

    .typing-indicator {
      display: flex;
      align-items: center;
      gap: 5px;
      padding: 10px 14px;
    }
    .typing-indicator .dot {
      width: 8px;
      height: 8px;
      background-color: #94a3b8; /* slate-400 */
      border-radius: 50%;
      animation: bounce 1.2s infinite ease-in-out;
    }
    .typing-indicator .dot:nth-child(2) {
      animation-delay: -0.15s;
    }
    .typing-indicator .dot:nth-child(3) {
      animation-delay: -0.3s;
    }
    @keyframes bounce {
      0%, 80%, 100% { transform: scale(0); }
      40% { transform: scale(1.0); }
    }


    .chat-footer {
      padding: 12px;
      border-top: 1px solid #e2e8f0; /* slate-200 */
      background-color: var(--chat-bg);
    }
    .chat-footer form {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .chat-footer input {
      flex: 1;
      border: 1px solid #cbd5e1; /* slate-300 */
      border-radius: 9999px;
      padding: 10px 16px;
      font-size: 0.95rem;
      outline: none;
      transition: border-color 0.2s;
    }
    .chat-footer input:focus {
      border-color: var(--chat-primary);
    }
    .chat-footer button {
      width: 44px;
      height: 44px;
      border: none;
      border-radius: 50%;
      background: linear-gradient(45deg, var(--chat-primary), var(--chat-secondary));
      color: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.2s, opacity 0.2s;
    }
    .chat-footer button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: scale(1);
    }
    .chat-footer button:not(:disabled):hover {
      transform: scale(1.05);
    }
    .chat-footer button svg {
      width: 20px;
      height: 20px;
    }

  </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.1.0",
    "react-dom/": "https://esm.sh/react-dom@^19.1.0/",
    "react/": "https://esm.sh/react@^19.1.0/",
    "@google/genai": "https://esm.sh/@google/genai@^1.11.0"
  }
}
</script>
</head>

<body>

  <header class="navbar">
    <a href="#" class="logo">The Design</a>

    <nav>
      <div class="hamburger" id="hamburger">
        ☰
      </div>
      <ul class="nav-links" id="nav-links">
        <li><a href="#services">Services</a></li>
        <li><a href="#pricing">Pricing</a></li>
        <li><a href="#about">About</a></li>
        <li><a href="#contact">Contact</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <section class="hero" data-aos="fade-up">
      <div class="hero-content">
        <h1>We Build Brands That Stand Out</h1>
        <p class="highlight-line">From websites to logos, templates to invites — we design it all.</p><br>
        <a href="#contact" class="btn">Get Started</a>
      </div>
    </section>

    <section id="services" class="services" data-aos="fade-up">
      <h2>Our Services</h2>
      <div class="services-grid">
        <div class="service-card">
          <img src="assets/images/web.png" alt="Website Development">
          <p>Website Development</p>
        </div>
        <div class="service-card">
          <img src="assets/images/l1.png" alt="Logo Design">
          <p>Logo Design</p>
        </div>
        <div class="service-card">
          <img src="assets/images/g.png" alt="Graphic Design">
          <p>Graphic Design</p>
        </div>
        <div class="service-card">
          <img src="assets/images/inv.png" alt="Invitation Design">
          <p>Invitation Design</p>
        </div>
        <div class="service-card">
          <img src="assets/images/t.png" alt="Template Making">
          <p>Template Making</p>
        </div>
        <div class="service-card">
          <img src="assets/images/more.png" alt="More on Request">
          <p>More on Request</p>
        </div>
      </div>
    </section>
    
    <section id="pricing" class="pricing" data-aos="fade-up">
      <h2>Our Pricing</h2>

      <!-- Website Plans -->
      <h2 style="margin-top: 2rem;">Website Design Plans</h2>
      <div class="pricing-grid">
        <div class="pricing-card">
          <h3>Silver</h3>
          <p class="price">$100</p>
          <ul>
            <li>Basic Website (3 Pages)</li>
            <li>Mobile Friendly</li>
            <li>Email Support</li>
            <li>2 Revisions</li>
          </ul>
          <a href="payment.html?plan=website-silver" class="btn">Buy Now</a>
        </div>
        <div class="pricing-card highlight">
          <h3>Gold</h3>
          <p class="price">$200</p>
          <ul>
            <li>5-Page Website</li>
            <li>Mobile Optimized</li>
            <li>SEO Ready</li>
            <li>3 Revisions</li>
          </ul>
          <a href="payment.html?plan=website-gold" class="btn">Buy Now</a>
        </div>
        <div class="pricing-card">
          <h3>Platinum</h3>
          <p class="price">$400</p>
          <ul>
            <li>Full Website</li>
            <li>All Gold Features </li>
            <li>Branding & Strategy</li>
            <li>Social Media presence </li>
          </ul>
          <a href="payment.html?plan=website-platinum" class="btn">Buy Now</a>
        </div>
      </div>

      <!-- Logo Design -->
      <h2 style="margin-top: 4rem;">Logo Design</h2>
      <div class="pricing-grid">
        <div class="pricing-card">
          <h3>Basic Logo</h3>
          <p class="price">$50</p>
          <ul>
            <li>1 Logo Concept</li>
            <li>PNG, JPG Formats</li>
            <li>2 Revision</li>
          </ul>
          <a href="payment.html?plan=logo-basic" class="btn">Buy Now</a>
        </div>
        <div class="pricing-card highlight">
          <h3>Standard Logo</h3>
          <p class="price">$100</p>
          <ul>
            <li>2 Concepts</li>
            <li>Any format Files</li>
            <li>3 Revisions</li>
          </ul>
          <a href="payment.html?plan=logo-standard" class="btn">Buy Now</a>
        </div>
        <div class="pricing-card">
          <h3>Premium Logo</h3>
          <p class="price">$150</p>
          <ul>
            <li>3 Premium Concepts</li>
            <li>All Source Files</li>
            <li>5 Revisions</li>
          </ul>
          <a href="payment.html?plan=logo-premium" class="btn">Buy Now</a>
        </div>
      </div>

      <!-- Other Design Services -->
      <h2 style="margin-top: 4rem;">Other Design Services</h2>
      <div class="pricing-grid">
        <div class="pricing-card">
          <h3>Graphic Design</h3>
          <p class="price">$25</p>
          <ul>
            <li>2 Social Media Posts</li>
            <li>Custom Sizes</li>
            <li>Editable Templates</li>
          </ul>
          <a href="payment.html?plan=graphic" class="btn">Buy Now</a>
        </div>
        <div class="pricing-card highlight">
          <h3>Invitation Design</h3>
          <p class="price">$30</p>
          <ul>
            <li>2 Custom Invites</li>
            <li>Print & Digital Versions</li>
            <li>Theme Based</li>
          </ul>
          <a href="payment.html?plan=invitation" class="btn">Buy Now</a>
        </div>
        <div class="pricing-card">
          <h3>Template Making</h3>
          <p class="price">$20</p>
          <ul>
            <li>2 Templates</li>
            <li>Editable in Canva</li>
            <li>Brand-Aligned</li>
          </ul>
          <a href="payment.html?plan=template" class="btn">Buy Now</a>
        </div>
      </div>

      <!-- More on Request -->
      <h2 style="margin-top: 4rem;">More on Request</h2>
      <div class="pricing-grid">
        <div class="pricing-card" style="width:100%; max-width:500px; margin: auto;">
          <h3>Custom Services</h3>
          <p class="price">Based on the request</p>
          <ul>
            <li>Any Design Request</li>
            <li>Custom Quotes</li>
            <li>Faster Delivery</li>
          </ul>
          <a href="payment.html?plan=custom" class="btn">Buy Now</a>
        </div>
      </div>
    </section>

    <section id="about" class="about" data-aos="fade-up">
      <h2>About Us</h2>
      <p>We are a creative agency crafting bold, modern design solutions for visionary clients. Simplicity, elegance, and functionality — all in one place.</p>
      <p>From startups to established brands, we work with businesses of all sizes to bring their vision to life. Our team specializes in everything from logo design and website development to personalized invitations and custom templates.</p>
      <p>With a passion for creativity and a focus on quality, we ensure every design speaks your brand's language. Whether you're launching a new product or revamping your identity, we're here to deliver results that are not only beautiful but also strategic.</p>
      <p>✨ Let's collaborate and turn your ideas into impactful visual stories.</p>
    </section>
    
    <section class="why-us" data-aos="fade-up">
      <h2>Why Choose The Design?</h2>
      <div class="why-grid">
        <div class="why-card">✅ Fast & Timely Delivery</div>
        <div class="why-card">🎯 100% Custom Designs</div>
        <div class="why-card">📞 Easy Client Communication</div>
        <div class="why-card">💰 Affordable Pricing</div>
      </div>
    </section>

    <section class="portfolio" data-aos="fade-up">
      <h2>Our Work</h2>
      <div class="portfolio-grid">
        <a href="https://www.instagram.com/silvrie_official/" class="portfolio-item" target="_blank">
          <img src="assets/images/Logo.JPG" alt="Logo - SILVRIE">
          <p>Logo - SILVRIE</p>
        </a>
        
        <a href="https://atraine.onrender.com/" class="portfolio-item" target="_blank">
          <img src="assets/images/project-7.png"  alt="Website - ATRAINE">
          <p>Website - ATRAINE</p>
        </a>
    
        <a href="https://www.instagram.com/the_printtt/" class="portfolio-item" target="_blank">
          <img src="assets/images/BABYSHOWER.png" alt="Invite - Baby Shower Theme">
          <p>Invite - Baby Shower Theme</p>
        </a>
    
        <a href="https://health-matrix.onrender.com/" class="portfolio-item" target="_blank">
          <img src="assets/images/UI.png" alt="UI Mockup - Food Delivery App">
          <p>UI Mockup - HEALTH MATRIX App</p>
        </a>
      </div>
    </section>
    
    <section class="testimonials" data-aos="fade-up">
      <h2>What Our Clients Say</h2>
      <div class="testimonial-grid">
        <div class="testimonial-card">
          <p>“Amazing service & communication!”</p>
          <h4>- Arjun, Mumbai</h4>
        </div>
        <div class="testimonial-card">
          <p>“Fast delivery & beautiful designs. Highly recommend.”</p>
          <h4>- Meera, Bangalore</h4>
        </div>
      </div>
    </section>

    <section class="faq" data-aos="fade-up">
      <h2>Frequently Asked Questions</h2>
      <div class="faq-item">
        <h3>How do I place an order?</h3>
        <p>Use the contact form or DM us on Instagram to get started.</p>
      </div>
      <div class="faq-item">
        <h3>Do you take urgent orders?</h3>
        <p>Yes, based on availability and type of design.</p>
      </div>
      <div class="faq-item">
        <h3>Can I request changes?</h3>
        <p>Yes! We offer up to 2 revisions for free.</p>
      </div>
    </section>

    <section id="contact" class="contact" data-aos="fade-up">
      <h2>Contact Us</h2>
      <form id="contactForm" action="https://formsubmit.co/sukhmangill977@gmail.com" method="POST">
        <input type="text" name="name" placeholder="Your Name" required />
        <input type="email" name="email" placeholder="Your Email" required />
        <textarea name="message" placeholder="Your Message" required></textarea>
        <input type="hidden" name="_captcha" value="false">
        <input type="hidden" name="_redirect" value="">
        <button type="submit" class="btn">Send Message</button>
        <p id="responseMessage" class="hidden">Thanks for reaching out! We'll be in touch soon.</p>
      </form>
    </section>
  </main>

  <footer>
    <p>&copy; 2025 The Design. All rights reserved.</p>
    <p>
      <a href="mailto:sukhmangill977@gmail.com">sukhmangill977@gmail.com</a> |
      <a href="https://www.instagram.com/">Instagram</a>
    </p>
  </footer>
  
  <!-- AI CHATBOT WIDGET START -->
  <div id="ai-chat-container">
  <div id="chat-icon-container">
    <div id="chat-icon">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
          <path fill-rule="evenodd" d="M4.848 2.771A49.144 49.144 0 0112 2.25c2.43 0 4.817.178 7.152.52 1.978.292 3.348 2.024 3.348 3.97v6.02c0 1.946-1.37 3.678-3.348 3.97a48.901 48.901 0 01-3.476.383.39.39 0 00-.297.15l-2.11 2.11a.75.75 0 01-1.06 0l-2.11-2.11a.39.39 0 00-.297-.15 48.9 48.9 0 01-3.476-.384c-1.978-.29-3.348-2.024-3.348-3.97V6.741c0-1.946 1.37-3.678 3.348-3.97zM6.75 8.25a.75.75 0 01.75-.75h9a.75.75 0 010 1.5h-9a.75.75 0 01-.75-.75zm.75 2.25a.75.75 0 000 1.5H12a.75.75 0 000-1.5H7.5z" clip-rule="evenodd" />
      </svg>
    </div>
    <div id="chat-window" class="hidden">
        <div class="chat-header">
            <h3>The Design AI</h3>
            <button id="close-chat-btn">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path fill-rule="evenodd" d="M5.47 5.47a.75.75 0 011.06 0L12 10.94l5.47-5.47a.75.75 0 111.06 1.06L13.06 12l5.47 5.47a.75.75 0 11-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 01-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 010-1.06z" clip-rule="evenodd" /></svg>
            </button>
        </div>
        <div class="chat-body" id="chat-body">
            <!-- Messages will be injected here -->
        </div>
        <div class="chat-footer">
            <form id="chat-form">
                <input type="text" id="chat-input" placeholder="Ask about services..." autocomplete="off">
                <button type="submit" id="send-btn">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M3.478 2.405a.75.75 0 00-.926.94l2.432 7.905H13.5a.75.75 0 010 1.5H4.984l-2.432 7.905a.75.75 0 00.926.94 60.519 60.519 0 0018.445-8.986.75.75 0 000-1.218A60.517 60.517 0 003.478 2.405z" /></svg>
                </button>
            </form>
        </div>
    </div>
  </div>
  <!-- AI CHATBOT WIDGET END -->

  <!-- Scripts at end -->
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script>
    AOS.init();
    // Hamburger menu logic
    const hamburger = document.getElementById('hamburger');
    const navLinks = document.getElementById('nav-links');
    hamburger.addEventListener('click', () => {
      navLinks.classList.toggle('active'); // You will need to add a 'nav-links.active' style in style.css
    });
  </script>

  <script type="module">
    // -------------------------------------------------------------------
    // AI CHATBOT LOGIC
    // -------------------------------------------------------------------
    import { GoogleGenAI } from "https://esm.sh/@google/genai@^0.14.1";

    // --- CONFIGURATION ---
    // IMPORTANT: REPLACE "YOUR_API_KEY_HERE" WITH YOUR ACTUAL GOOGLE AI API KEY
    const API_KEY = "AIzaSyD8V4LqtTsb_a3T9bU5xnBfAUWo2mLZN18";
    
    const SYSTEM_INSTRUCTION = `
      You are a friendly and professional AI assistant for 'The Design', a creative SaaS solutions company. 
      Your goal is to answer user questions based ONLY on the information provided below. 
      Do not invent services, prices, or contact details. Be helpful and encourage users to get in touch for custom quotes or to start a project.
      If you don't know the answer from this context, politely say that you don't have that information and suggest contacting the team directly via email or Instagram.

      ---
      **COMPANY INFORMATION:**
      - **Name:** The Design
      - **Slogan:** We Build Brands That Stand Out.
      - **About:** We are a creative agency crafting bold, modern design solutions for visionary clients. We focus on simplicity, elegance, and functionality. We work with everyone from startups to established brands. Our team specializes in everything from logo design and website development to personalized invitations and custom templates.
      - **Why Choose Us:** Fast & Timely Delivery, 100% Custom Designs, Easy Client Communication, Affordable Pricing.

      **SERVICES OFFERED:**
      - Website Development
      - Logo Design
      - Graphic Design
      - Invitation Design
      - Template Making
      - Custom services are available on request.

      **PRICING DETAILS:**
      **Website Design Plans:**
      - **Silver:** $100. Includes: Basic Website (3 Pages), Mobile Friendly, Email Support, 2 Revisions.
      - **Gold:** $200. Includes: 5-Page Website, Mobile Optimized, SEO Ready, 3 Revisions.
      - **Platinum:** $400. Includes: Full Website, All Gold Features, Branding & Strategy, Social Media presence.
      **Logo Design Plans:**
      - **Basic Logo:** $50. Includes: 1 Logo Concept, PNG & JPG Formats, 2 Revisions.
      - **Standard Logo:** $100. Includes: 2 Concepts, Any format Files, 3 Revisions.
      - **Premium Logo:** $150. Includes: 3 Premium Concepts, All Source Files, 5 Revisions.
      **Other Design Services:**
      - **Graphic Design:** $25. Includes: 2 Social Media Posts, Custom Sizes, Editable Templates.
      - **Invitation Design:** $30. Includes: 2 Custom Invites, Print & Digital Versions, Theme Based.
      - **Template Making:** $20. Includes: 2 Templates, Editable in Canva, Brand-Aligned.
      - **Custom Services:** Pricing is based on the request. For any design not listed, we provide custom quotes.

      **CONTACT INFORMATION:**
      - **Email:** sukhmangill977@gmail.com
      - **Instagram:** @the.print_
      ---

      Start the conversation by greeting the user and asking how you can help them with their design needs today.
    `;

    // --- DOM ELEMENT REFERENCES ---
    const chatIcon = document.getElementById('chat-icon');
    const chatWindow = document.getElementById('chat-window');
    const closeChatBtn = document.getElementById('close-chat-btn');
    const chatBody = document.getElementById('chat-body');
    const chatForm = document.getElementById('chat-form');
    const chatInput = document.getElementById('chat-input');
    const sendBtn = document.getElementById('send-btn');

    let chat; // This will hold our chat session
    let isChatOpen = false;
    let hasInitialized = false;

    // --- INITIALIZE GEMINI ---
    const initGemini = () => {
        if (API_KEY === "YOUR_API_KEY_HERE") {
            console.error("Please replace 'YOUR_API_KEY_HERE' with your actual Google AI API key.");
            return null;
        }
        const ai = new GoogleGenAI({ apiKey: API_KEY });
        return ai.chats.create({
            model: 'gemini-2.5-flash',
            config: { systemInstruction: SYSTEM_INSTRUCTION },
        });
    }
    
    // --- UI HELPER FUNCTIONS ---
    const toggleChatWindow = () => {
      isChatOpen = !isChatOpen;
      chatWindow.classList.toggle('hidden');
      chatIcon.classList.toggle('hidden');
      if (isChatOpen && !hasInitialized) {
        startConversation();
        hasInitialized = true;
      }
    };
    
    const scrollToBottom = () => {
      chatBody.scrollTop = chatBody.scrollHeight;
    };

    const setFormState = (isLoading) => {
        chatInput.disabled = isLoading;
        sendBtn.disabled = isLoading;
    };

    const showTypingIndicator = () => {
        const typingEl = document.createElement('div');
        typingEl.className = 'message-bubble bot-message typing-indicator';
        typingEl.innerHTML = `<div class="dot"></div><div class="dot"></div><div class="dot"></div>`;
        chatBody.appendChild(typingEl);
        scrollToBottom();
        return typingEl;
    };

    const addMessage = (author, text) => {
      const messageEl = document.createElement('div');
      messageEl.className = `message-bubble ${author}-message`;
      messageEl.textContent = text;
      chatBody.appendChild(messageEl);
      scrollToBottom();
      return messageEl;
    }

    // --- CORE CHAT LOGIC ---
    const streamResponse = async (prompt) => {
        if (!chat) {
          addMessage('bot', 'Chat is not initialized. Please ensure your API key is correct.');
          return;
        }

        setFormState(true);
        const typingIndicator = showTypingIndicator();
        
        try {
            const result = await chat.sendMessageStream({ message: prompt });
            let responseText = "";
            let messageEl = null;

            for await (const chunk of result) {
                if (typingIndicator && typingIndicator.parentNode) {
                    typingIndicator.remove();
                }
                responseText += chunk.text;
                if (!messageEl) {
                    messageEl = addMessage('bot', responseText);
                } else {
                    messageEl.textContent = responseText;
                    scrollToBottom();
                }
            }
        } catch (error) {
            console.error("Error streaming response:", error);
            if (typingIndicator && typingIndicator.parentNode) {
                typingIndicator.remove();
            }
            addMessage('bot', "I'm having trouble connecting right now. Please try again later.");
        } finally {
            setFormState(false);
            chatInput.focus();
        }
    };

    const handleFormSubmit = async (e) => {
      e.preventDefault();
      const userInput = chatInput.value.trim();
      if (!userInput) return;
      
      addMessage('user', userInput);
      chatInput.value = '';
      await streamResponse(userInput);
    };

    const startConversation = async () => {
      chat = initGemini();
      if (chat) {
        // Send a "hello" to trigger the initial greeting from the system prompt
        await streamResponse("Hello");
      } else {
        addMessage('bot', 'AI assistant could not be started. Please check the API key.');
        setFormState(true);
      }
    };

    // --- EVENT LISTENERS ---
    chatIcon.addEventListener('click', toggleChatWindow);
    closeChatBtn.addEventListener('click', toggleChatWindow);
    chatForm.addEventListener('submit', handleFormSubmit);

  </script>

</body>
</html>